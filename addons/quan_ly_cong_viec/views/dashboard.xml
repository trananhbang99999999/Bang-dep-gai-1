<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <data>

    <!-- ‚úÖ PIVOT VIEW (B·∫£ng ph√¢n t√≠ch) -->
    <record id="view_project_task_pivot" model="ir.ui.view">
      <field name="name">project_task.pivot</field>
      <field name="model">project_task</field>
      <field name="arch" type="xml">
        <pivot string="Ph√¢n T√≠ch C√¥ng Vi·ªác Chi Ti·∫øt">
          <field name="phong_ban_id" type="row"/>
          <field name="state" type="row"/>
          <field name="priority" type="col"/>
          <field name="progress" type="measure"/>
        </pivot>
      </field>
    </record>

    <!-- ‚úÖ GRAPH VIEW - Bi·ªÉu ƒë·ªì theo tr·∫°ng th√°i -->
    <record id="view_project_task_graph_state" model="ir.ui.view">
      <field name="name">project_task.graph.state</field>
      <field name="model">project_task</field>
      <field name="arch" type="xml">
        <graph string="C√¥ng Vi·ªác Theo Tr·∫°ng Th√°i" type="pie">
          <field name="state"/>
        </graph>
      </field>
    </record>

    <!-- ‚úÖ GRAPH VIEW - Bi·ªÉu ƒë·ªì theo ∆∞u ti√™n -->
    <record id="view_project_task_graph_priority" model="ir.ui.view">
      <field name="name">project_task.graph.priority</field>
      <field name="model">project_task</field>
      <field name="arch" type="xml">
        <graph string="C√¥ng Vi·ªác Theo M·ª©c ƒê·ªô ∆Øu Ti√™n" type="bar">
          <field name="priority"/>
          <field name="estimated_hours" type="measure"/>
        </graph>
      </field>
    </record>

    <!-- ‚úÖ GRAPH VIEW - Bi·ªÉu ƒë·ªì theo b·ªô ph·∫≠n -->
    <record id="view_project_task_graph_department" model="ir.ui.view">
      <field name="name">project_task.graph.department</field>
      <field name="model">project_task</field>
      <field name="arch" type="xml">
        <graph string="C√¥ng Vi·ªác Theo B·ªô Ph·∫≠n" type="bar">
          <field name="phong_ban_id"/>
          <field name="estimated_hours" type="measure"/>
        </graph>
      </field>
    </record>

    <!-- ‚úÖ KANBAN VIEW (B·∫£ng Kanban - d·ªÖ qu·∫£n l√Ω) -->
    <record id="view_project_task_kanban" model="ir.ui.view">
      <field name="name">project_task.kanban</field>
      <field name="model">project_task</field>
      <field name="arch" type="xml">
        <kanban default_group_by="state" quick_create="false">
          <field name="id"/>
          <field name="name"/>
          <field name="customer_id"/>
          <field name="nhan_vien_id"/>
          <field name="priority"/>
          <field name="deadline"/>
          <field name="is_overdue"/>
          <field name="progress"/>
          <field name="state"/>

          <templates>
            <t t-name="kanban-box">
              <div t-attf-class="oe_kanban_card oe_kanban_global_click #{record.is_overdue.raw_value and 'border-danger' or ''}">
                <div class="oe_kanban_content">
                  <!-- M√£ nhi·ªám v·ª• -->
                  <div>
                    <strong><field name="project_task_id"/></strong>
                  </div>

                  <!-- T√™n c√¥ng vi·ªác -->
                  <div class="o_text_overflow">
                    <strong><field name="name"/></strong>
                  </div>

                  <!-- Kh√°ch h√†ng -->
                  <div class="text-muted">
                    <small>KH: <field name="customer_id"/></small>
                  </div>

                  <!-- Nh√¢n vi√™n -->
                  <div class="text-muted">
                    <small>NV: <field name="nhan_vien_id"/></small>
                  </div>

                  <!-- Deadline -->
                  <div t-if="record.deadline.raw_value">
                    <small>
                      <t t-if="record.is_overdue.raw_value">
                        <span class="badge badge-danger">‚ö†Ô∏è Qu√° h·∫°n</span>
                      </t>
                      <t t-else="">
                        <span class="badge badge-info"><field name="deadline"/></span>
                      </t>
                    </small>
                  </div>

                  <!-- Progress Bar -->
                  <div class="mt-2">
                    <div class="progress" style="height: 20px;">
                      <div t-attf-class="progress-bar #{record.progress.raw_value >= 100 and 'bg-success' or record.progress.raw_value >= 50 and 'bg-warning' or 'bg-info'}"
                           t-attf-style="width: #{record.progress.raw_value}%">
                        <span style="color: white; font-size: 12px;"><field name="progress"/>%</span>
                      </div>
                    </div>
                  </div>

                  <!-- Priority Badge -->
                  <div class="mt-2">
                    <span t-attf-class="badge #{record.priority.raw_value == 'urgent' and 'badge-danger' or record.priority.raw_value == 'high' and 'badge-warning' or 'badge-secondary'}">
                      <field name="priority"/>
                    </span>
                  </div>
                </div>
              </div>
            </t>
          </templates>
        </kanban>
      </field>
    </record>

    <!-- ‚úÖ CALENDAR VIEW (L·ªãch deadline) -->
    <record id="view_project_task_calendar" model="ir.ui.view">
      <field name="name">project_task.calendar</field>
      <field name="model">project_task</field>
      <field name="arch" type="xml">
        <calendar string="L·ªãch C√¥ng Vi·ªác" date_start="deadline" color="priority">
          <field name="name"/>
          <field name="customer_id"/>
          <field name="nhan_vien_id"/>
        </calendar>
      </field>
    </record>

    <!-- ‚úÖ ACTION PIVOT (B·∫£ng ph√¢n t√≠ch ri√™ng) -->
    <record id="action_project_task_pivot" model="ir.actions.act_window">
      <field name="name">üìä Ph√¢n T√≠ch Chi Ti·∫øt</field>
      <field name="res_model">project_task</field>
      <field name="view_mode">pivot,graph,form</field>
      <field name="view_id" ref="view_project_task_pivot"/>
    </record>

    <!-- ‚úÖ ACTION GRAPH - Tr·∫°ng th√°i -->
    <record id="action_project_task_graph_state" model="ir.actions.act_window">
      <field name="name">üìà Bi·ªÉu ƒê·ªì Tr·∫°ng Th√°i</field>
      <field name="res_model">project_task</field>
      <field name="view_mode">graph,pivot,form</field>
      <field name="view_id" ref="view_project_task_graph_state"/>
    </record>

    <!-- ‚úÖ ACTION GRAPH - ∆Øu ti√™n -->
    <record id="action_project_task_graph_priority" model="ir.actions.act_window">
      <field name="name">üö® Bi·ªÉu ƒê·ªì M·ª©c ƒê·ªô ∆Øu Ti√™n</field>
      <field name="res_model">project_task</field>
      <field name="view_mode">graph,pivot,form</field>
      <field name="view_id" ref="view_project_task_graph_priority"/>
    </record>

    <!-- ‚úÖ ACTION GRAPH - B·ªô ph·∫≠n -->
    <record id="action_project_task_graph_department" model="ir.actions.act_window">
      <field name="name">üè¢ Bi·ªÉu ƒê·ªì B·ªô Ph·∫≠n</field>
      <field name="res_model">project_task</field>
      <field name="view_mode">graph,pivot,form</field>
      <field name="view_id" ref="view_project_task_graph_department"/>
    </record>

    <!-- ‚úÖ ACTION KANBAN (B·∫£ng Kanban ri√™ng) -->
    <record id="action_project_task_kanban" model="ir.actions.act_window">
      <field name="name">C√¥ng Vi·ªác - Kanban</field>
      <field name="res_model">project_task</field>
      <field name="view_mode">kanban,form,tree</field>
      <field name="view_id" ref="view_project_task_kanban"/>
    </record>

    <!-- ‚úÖ ACTION CALENDAR (L·ªãch ri√™ng) -->
    <record id="action_project_task_calendar" model="ir.actions.act_window">
      <field name="name">L·ªãch C√¥ng Vi·ªác</field>
      <field name="res_model">project_task</field>
      <field name="view_mode">calendar,kanban,form</field>
      <field name="view_id" ref="view_project_task_calendar"/>
    </record>

  </data>
</odoo>
